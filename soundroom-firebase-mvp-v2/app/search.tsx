
import { useEffect, useState } from 'react'; import { Text, TextInput, ScrollView, Pressable } from 'react-native'; import { theme } from '@/lib/theme'; import { useRouter } from 'expo-router'; import seed from '@/data/seed.json'; import { db } from '@/lib/firebase'; import { collection, getDocs, limit, query } from 'firebase/firestore';
export default function Search(){ const [qtext,setQ]=useState(''); const [artists,setArtists]=useState<any[]>(seed.artists); const router=useRouter(); useEffect(()=>{(async()=>{try{const snap=await getDocs(query(collection(db,'artists'),limit(50))); const list=snap.docs.map(d=>({handle:d.id,...d.data()})); if(list.length) setArtists(list);}catch{}})();},[]);
const results=artists.filter(a=>(a.handle||'').toLowerCase().includes(qtext.toLowerCase())||(a.displayName||'').toLowerCase().includes(qtext.toLowerCase()));
return (<ScrollView style={{backgroundColor:theme.bg,padding:16}}><TextInput placeholder="Search artists" placeholderTextColor={theme.subtext} value={qtext} onChangeText={setQ} style={{backgroundColor:theme.card,color:theme.text,borderRadius:12,padding:12,marginBottom:12}}/>
{results.map(a=>(<Pressable key={a.handle} onPress={()=>router.push(`/artist/${a.handle}`)} style={{backgroundColor:theme.card,borderRadius:12,padding:12,marginBottom:12}}><Text style={{color:theme.text,fontSize:18,fontWeight:'700'}}>{a.displayName}</Text><Text style={{color:theme.subtext}}>@{a.handle}</Text></Pressable>))}
{results.length===0? <Text style={{color:theme.subtext}}>No artists yet. Try "stephhh".</Text>:null}</ScrollView>); }
